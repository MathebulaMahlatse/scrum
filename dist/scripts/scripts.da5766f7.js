"use strict";angular.module("prodAngularApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","scrum.teamController","scrum.storiesService","scrum.storiesController","scrum.teamModal","scrum.storiesModal"]).config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/scrumTeams.html",controller:"TeamController"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/stories",{templateUrl:"views/stories.html",controller:"StoriesController"}).otherwise({redirectTo:"/"}),b.hashPrefix("")}]),angular.module("prodAngularApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("prodAngularApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]);var module=angular.module("scrum.storiesService",[]);module.factory("StoriesService",["$http","$q",function(a,b){function c(a){var b=_.last(a);return b.storyId+1}function d(a){return _.last(a).teamId}var e={},f=void 0;return{getStoriesAssignedToTeams:function(){if(_.isUndefined(f))return a.get("/mock/scrumData.json").then(function(a){return f=a.data,a.data});var c=b.defer();return c.resolve(f),c.promise},addStoriesAssignedToTeam:function(a){var b=a.story;_.forEach(f.teams,function(d){return d.teamId==a.teamId?(d.stories.push({storyId:c(d.stories),description:b.description,estimation:b.estimation,owner:b.owner,status:b.status}),d):d})},storeTeam:function(a){f.teams.push({teamId:d(f.teams),teamName:a.teamName,stories:a.stories})},storeSelectedTeam:function(a){e=a},retrieveSelectedTeam:function(){return e}}}]);var module=angular.module("scrum.teamController",["angularModalService"]);module.controller("TeamController",["$scope","StoriesService","$location","ModalService",function(a,b,c,d){function e(a){return _.map(a,function(a){return a.statusOfStories={backlog:_.filter(a.stories,{status:"backlog"}).length,todo:_.filter(a.stories,{status:"todo"}).length,inProgress:_.filter(a.stories,{status:"in progress"}).length,done:_.filter(a.stories,{status:"done"}).length},a})}b.getStoriesAssignedToTeams().then(function(b){a.teamsAndStoriesOverview=e(b.teams)}),a.selectTeam=function(a){b.storeSelectedTeam(a),c.path("/stories")},a.addTeam=function(){d.showModal({templateUrl:"views/teamModal.html",controller:"TeamModalController",inputs:{title:"Adding a team"}}).then(function(b){b.element.modal(),b.close.then(function(b){a.teamsAndStoriesOverview.push({teamName:b.teamName,statusOfStories:{backlog:0,todo:0,inProgress:0,done:0}})})})}}]);var module=angular.module("scrum.storiesController",["scrum.storiesService","angularModalService"]);module.controller("StoriesController",["$scope","$location","StoriesService","ModalService",function(a,b,c,d){function e(b){a.backlogTasks=_.filter(b.stories,{status:"backlog"}),a.todoTasks=_.filter(b.stories,{status:"todo"}),a.inProgressTasks=_.filter(b.stories,{status:"in progress"}),a.completedTasks=_.filter(b.stories,{status:"done"})}var f=c.retrieveSelectedTeam();f&&!f.teamName&&b.path("/"),a.teamName=f&&f.teamName,e(f),a.addOrEditStory=function(a){d.showModal({templateUrl:"views/storiesModal.html",controller:"StoriesModalController",inputs:{title:a}}).then(function(a){a.element.modal(),a.close.then(function(a){})})},a.storiesViewModel=[{header:"Backlog",stories:a.backlogTasks},{header:"Todo",stories:a.todoTasks},{header:"In progress",stories:a.inProgressTasks},{header:"Done",stories:a.completedTasks}]}]);var app=angular.module("scrum.teamModal",[]);app.controller("TeamModalController",["$scope","$element","title","close",function(a,b,c,d){a.title=c,a.name=null,a.close=function(){d({teamName:a.name},500)},a.cancel=function(){b.modal("hide"),d({teamName:a.name},500)}}]);var app=angular.module("scrum.storiesModal",[]);app.controller("StoriesModalController",["$scope","$element","title","close",function(a,b,c,d){a.description=c&&c.description,a.estimation=c&&c.estimation,a.owner=c&&c.owner,a.status=c&&c.status,a.title=c.status,a.close=function(){d({description:a.description,estimation:a.estimation,owner:a.owner,status:a.status},500)},a.cancel=function(){b.modal("hide"),d({description:a.description,estimation:a.estimation,owner:a.owner,status:a.status},500)}}]);